---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "rafay_ztkarule Resource - terraform-provider-rafay"
subcategory: ""
description: |-
  
---

# rafay_ztkarule (Resource)

ZTKA Rules are Kubernetes RBAC objects(ClusterRole and Role) that will be applied for user inside cluster and enforced for kubectl access through Rafay.

## Example Usage

Create ZTAK Rule by uploading file from local system. 
```terraform
resource "rafay_ztkarule" "test_rafay_ztkarule_local_file" {
  metadata {
    name = "test-ztkarule"
  }
  spec {
    artifact {
      type = "Yaml"
      artifact {
        paths {
          name = "file://artifact/ztka-rule/rule.yaml"
        }
      }
      options {
        force                       = true
        disable_open_api_validation = true
      }
    }
    cluster_selector {
      select_all = true
    }
    project_selector {
      match_names = [
        "defaultproject"
      ]
      select_all = false
    }
    version = "v1"
  }
}
```

Create ZTAK Rule by  from git repo.
```terraform
resource "rafay_ztkarule" "test_rafay_ztkarule_local_file" {
  metadata {
    name = "test-ztkarule"
  }
  spec {
    artifact {
      type = "Yaml"
      artifact {
        paths {
          name = "git-repo-folder/ztka-rules/rule1.yaml"
        }
        project    = "defaultproject"
        repository = "ztka-repo"
        revision   = "master"
      }
      options {
        force                       = true
        disable_open_api_validation = true
      }
    }
    cluster_selector {
      select_all = true
    }
    project_selector {
      match_names = [
        "defaultproject"
      ]
      select_all = false
    }
    version = "v1"
  }
}
```

<!-- schema generated by tfplugindocs -->
## Schema


***Required***
- `metadata` (Block List, Max: 1) Metadata of the ztka rule  resource (see [below for nested schema](#nestedblock--metadata))
- `spec` (Block List, Max: 1) Specification of the ztka rule  resource (see [below for nested schema](#nestedblock--spec))

***Optional***

- `timeouts` (Block, Optional) (see [below for nested schema](#nestedblock--timeouts))

<a id="nestedblock--metadata"></a>
### Nested Schema for `metadata`

***Required***

- `name` (String) name of the resource

***Optional***

- `annotations` (Map of String) annotations of the resource
- `description` (String) description of the resource
- `labels` (Map of String) labels of the resource


<a id="nestedblock--spec"></a>
### Nested Schema for `spec`

***Required***

- `artifact` (Block List, Max: 1) ztka rule  artifact specification (see [below for nested schema](#nestedblock--spec--artifact))
- `cluster_selector` (Block List, Max: 1) Cluster Selector to specify clusters in which rules to apply (see [below for nested schema](#nestedblock--spec--cluster_selector))
- `project_selector` (Block List, Max: 1) Project Selector to specify projects to which rules to apply (see [below for nested schema](#nestedblock--spec--project_selector))
- `version` (String) version of the ztka rule

<a id="nestedblock--spec--artifact"></a>
### Nested Schema for `spec.artifact`

***Required***

- `artifact` (Block List, Max: 1) (see [below for nested schema](#nestedblock--spec--artifact--artifact))
- `type` (String) type of the artifact, Supported values are: `Yaml`

***Optional***

- `options` (Block List, Max: 1) (see [below for nested schema](#nestedblock--spec--artifact--options))

<a id="nestedblock--spec--artifact--artifact"></a>
### Nested Schema for `spec.artifact.artifact`

***Required***
- `paths` (Block List) relative paths to file in the local file system or in git repository (see [below for nested schema](#nestedblock--spec--artifact--artifact--paths))

**Note**: Required for ztka rules created through git repo
- `project` (String) project name of the repository
- `repository` (String) name of the helm repository
- `revision` (String) branch or tag in the git repository


<a id="nestedblock--spec--artifact--artifact--paths"></a>
### Nested Schema for `spec.artifact.artifact.paths`

***Required***

- `name` (String) relative path of a artifact
- `sensitive` (Boolean) data is the base64 encoded contents of the file if set to true

<a id="nestedblock--spec--artifact--options"></a>
### Nested Schema for `spec.artifact.options`

***Optional***

- `atomic` (Boolean) deploy Helm artifact with atomic flag
- `clean_up_on_fail` (Boolean) cleanup deployed resources when chart fails to deploy
- `description` (String) custom description for the release
- `disable_open_api_validation` (Boolean) disable OpenAPI validation while deploying the YAML
- `force` (Boolean) deploy YAML artifact with force flag
- `keep_history` (Boolean) keep release history after uninstalling
- `max_history` (Number) limit Helm artifact history
- `no_hooks` (Boolean) deploy Helm artifact without hooks
- `render_sub_chart_notes` (Boolean) render sub chart notes
- `reset_values` (Boolean) reset existing helm values
- `reuse_values` (Boolean) reuse existing values
- `set_string` (List of String) pass custom helm values as key=value
- `skip_crd` (Boolean) skip deploying crds
- `timeout` (String) timeout for waiting for the resources to become ready
- `wait` (Boolean) deploy Helm artifact with wait flag
- `wait_for_jobs` (Boolean) deploy Helm artifact with --wait-for-jobs flag
- `wait_for_uninstall` (Boolean) uninstall Helm artifact with --wait flag



<a id="nestedblock--spec--cluster_selector"></a>
### Nested Schema for `spec.cluster_selector`

***Required***

- `match_labels` (Map of String)
- `match_names` (List of String)
- `select_all` (Boolean)


<a id="nestedblock--spec--project_selector"></a>
### Nested Schema for `spec.project_selector`

***Required***

- `match_names` (List of String)
- `select_all` (Boolean)



<a id="nestedblock--timeouts"></a>
### Nested Schema for `timeouts`

***Optional***

- `create` (String)
- `delete` (String)
- `update` (String)



# rafay_ztkarule ( import )
## Example Usage
The below command will help to import existing ZTKA rule resources from the controller to the state file.

---
```
terraform import rafay_ztkarule.demo_rafay_ztkarule_local_file  ztkaRuleName
```
The above command will import the ZTKA rule resources without the `artifact` object (i.e. `artifact` will be ignored), to import the `artifact` object refer below command.


```
terraform import rafay_ztkarule.demo_rafay_ztkarule_local_file ztkaRuleName/show_artifact
```
The `show_artifact`, in the end, will update the state file with the artifact object.

---
