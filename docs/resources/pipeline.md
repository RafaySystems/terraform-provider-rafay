---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "rafay_pipeline Resource - terraform-provider-rafay"
subcategory: ""
description: |-
  
---

# rafay_pipeline (Resource)



## Example Usage

```terraform
resource "rafay_pipeline" "tfdemopipeline1" {
  metadata {
    name    = "email-test"
    project = "terraform"
  }
  spec {
    active = false
    sharing {
      enabled = false
    }
    stages {
      config {
        approvers {
          sso_user  = false
          user_name = "hardik@rafay.co"
        }
        timeout = "2m0s"
        type    = "Email"
      }
      name = "email"
      type = "Approval"
    }
  }
}

resource "rafay_pipeline" "tfdemopipeline" {
  metadata {
    name        = "test2"
    project     = "terraform"
    annotations = {}
    labels      = {}
  }
  spec {
    stages {
      name = "s1"
      type = "SystemSync"
      next {
        name = "s2"
      }
      config {
        git_to_system_sync = true
        included_resources {
          name = "Workload"
        }
        excluded_resources {
          name = "OPAConstraint"
        }
        source_repo {
          repository = "test1"
          revision   = "main"
          path {
            name = "project"
          }
        }
        #destination_repo {}
        source_as_destination = true
        action {
          destroy       = false
          refresh       = false
          secret_groups = []
        }

      }
      variables {
        name  = "x"
        type  = "String"
        value = "trigger.name"
      }
    }
    stages {
      name = "s2"
      type = "Approval"
      next {
        name = "s3"
      }
      config {
        type = "Email"
        approvers {
          user_name = "user@company.co"
        }
        timeout = "10s"
        action {
          destroy       = false
          refresh       = false
          secret_groups = []
        }
      }
    }
    stages {
      name = "s3"
      type = "DeployWorkload"

      config {
        git_to_system_sync                      = false
        persist_working_directory               = false
        source_as_destination                   = false
        system_to_git_sync                      = false
        use_revision_from_webhook_trigger_event = false
        workload                                = "w2"

        action {
          destroy       = false
          refresh       = false
          secret_groups = []
        }
      }
    }
    triggers {
      type = "Webhook"
      name = "t1"
      config {
        repo {
          provider   = "Github"
          repository = "test1"
          revision   = "main"
          paths {
            name = "project"
          }
        }
      }
      variables {
        name  = "x"
        type  = "String"
        value = "trigger.name"
      }
    }
    triggers {
      type = "Webhook"
      name = "t2"
      config {
        repo {
          provider   = "AzureRepos"
          repository = "test1"
          revision   = "main"
          paths {
            name = "project"
          }
        }
      }
      variables {
        name  = "x"
        type  = "String"
        value = "trigger.name"
      }
    }
    # triggers {
    #     type =  "Cron"
    #     name = "t3"
    #     config {
    #         cron_expression = "0 0 * * *"
    #         repo {
    #             provider = "AzureRepos"
    #             repository = "test1"
    #             revision =  "main"
    #             paths {
    #                 name = "project"
    #             }
    #         }
    #     }
    #     variables {
    #         name = "x"
    #         type = "String"
    #         value = "trigger.name"
    #     }
    # }
    sharing {
      enabled = false
    }
    active = false
  }
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Optional

- `impersonate` (String) impersonate user
- `metadata` (Block List, Max: 1) Metadata of the pipeline resource (see [below for nested schema](#nestedblock--metadata))
- `spec` (Block List, Max: 1) Specification of the pipeline resource (see [below for nested schema](#nestedblock--spec))
- `timeouts` (Block, Optional) (see [below for nested schema](#nestedblock--timeouts))

### Read-Only

- `id` (String) The ID of this resource.

<a id="nestedblock--metadata"></a>
### Nested Schema for `metadata`

Optional:

- `annotations` (Map of String) annotations of the resource
- `description` (String) description of the resource
- `labels` (Map of String) labels of the resource
- `name` (String) name of the resource
- `project` (String) Project of the resource


<a id="nestedblock--spec"></a>
### Nested Schema for `spec`

Optional:

- `active` (Boolean) flag to indicate if pipeline is active
- `secret` (Block List, Max: 1) Pipeline secrets (see [below for nested schema](#nestedblock--spec--secret))
- `sharing` (Block List, Max: 1) pipeline sharing configuration (see [below for nested schema](#nestedblock--spec--sharing))
- `stages` (Block List) stages in the pipeline (see [below for nested schema](#nestedblock--spec--stages))
- `triggers` (Block List) triggers for the pipeline (see [below for nested schema](#nestedblock--spec--triggers))
- `variables` (Block List) pipeline scoped variables (see [below for nested schema](#nestedblock--spec--variables))

<a id="nestedblock--spec--secret"></a>
### Nested Schema for `spec.secret`

Optional:

- `name` (String) relative path of a artifact


<a id="nestedblock--spec--sharing"></a>
### Nested Schema for `spec.sharing`

Optional:

- `enabled` (Boolean) flag to specify if sharing is enabled for resource
- `projects` (Block List) list of projects this resource is shared to (see [below for nested schema](#nestedblock--spec--sharing--projects))

<a id="nestedblock--spec--sharing--projects"></a>
### Nested Schema for `spec.sharing.projects`

Optional:

- `name` (String) name of the project



<a id="nestedblock--spec--stages"></a>
### Nested Schema for `spec.stages`

Optional:

- `config` (Block List, Max: 1) (see [below for nested schema](#nestedblock--spec--stages--config))
- `name` (String) name of the pipeline stage
- `next` (Block List) list of stages to be executed after this (see [below for nested schema](#nestedblock--spec--stages--next))
- `pre_conditions` (Block List) conditions to be evaluated before executing current stage (see [below for nested schema](#nestedblock--spec--stages--pre_conditions))
- `type` (String) type of pipeline stage
- `variables` (Block List) stage scoped variables (see [below for nested schema](#nestedblock--spec--stages--variables))

<a id="nestedblock--spec--stages--config"></a>
### Nested Schema for `spec.stages.config`

Optional:

- `action` (Block List, Max: 1) (see [below for nested schema](#nestedblock--spec--stages--config--action))
- `agents` (Block List) list of agents to be used for provisioning (see [below for nested schema](#nestedblock--spec--stages--config--agents))
- `approvers` (Block List) list of approvers (see [below for nested schema](#nestedblock--spec--stages--config--approvers))
- `destination_repo` (Block List, Max: 1) git repository for syncing system to git (see [below for nested schema](#nestedblock--spec--stages--config--destination_repo))
- `excluded_resources` (Block List) resources to exclude from syncing (see [below for nested schema](#nestedblock--spec--stages--config--excluded_resources))
- `git_to_system_sync` (Boolean) flag to indicate if git to system sync should be enabled
- `included_resources` (Block List) resources to include for syncing (see [below for nested schema](#nestedblock--spec--stages--config--included_resources))
- `namespace` (String) namespace workload template should be deployed in
- `overrides` (Block List) overrides for workload template (see [below for nested schema](#nestedblock--spec--stages--config--overrides))
- `persist_working_directory` (Boolean) flag to indicate if working directory should be persisted
- `placement` (Block List, Max: 1) placement for workload template (see [below for nested schema](#nestedblock--spec--stages--config--placement))
- `provisioner` (String) name of the infrastructure provisioner
- `revision` (String) branch or tag for the git repository used in infrastructure provisioner
- `source_as_destination` (Boolean) flag to indicate if source repository should be used as destination repository
- `source_repo` (Block List, Max: 1) git repository for syncing from git to system (see [below for nested schema](#nestedblock--spec--stages--config--source_repo))
- `system_to_git_sync` (Boolean) flat to indicate if system to git sync should be enabled
- `timeout` (String) timeout for approval
- `type` (String) type of infraprovisioner
- `use_revision_from_webhook_trigger_event` (Boolean) flag to indicate weather to deploy workload using revision recieved from webhook trigger
- `working_directory` (String) working directory for the provisioner
- `workload` (String) name of the workload
- `workload_template` (String) name of workload template

<a id="nestedblock--spec--stages--config--action"></a>
### Nested Schema for `spec.stages.config.workload_template`

Optional:

- `action` (String) terraform action
- `backend_file_path` (Block List, Max: 1) backend file path (see [below for nested schema](#nestedblock--spec--stages--config--workload_template--backend_file_path))
- `backend_vars` (Block List) backend variables (see [below for nested schema](#nestedblock--spec--stages--config--workload_template--backend_vars))
- `destroy` (Boolean) destroy
- `env_vars` (Block List) environment variables (see [below for nested schema](#nestedblock--spec--stages--config--workload_template--env_vars))
- `input_vars` (Block List) input variables for terrafrom (see [below for nested schema](#nestedblock--spec--stages--config--workload_template--input_vars))
- `refresh` (Boolean) refresh
- `secret_groups` (List of String) Pipeline secrets groups
- `targets` (Block List) terraform targets (see [below for nested schema](#nestedblock--spec--stages--config--workload_template--targets))
- `tf_vars_file_path` (Block List, Max: 1) terraform variable file path (see [below for nested schema](#nestedblock--spec--stages--config--workload_template--tf_vars_file_path))
- `version` (String) terraform version

<a id="nestedblock--spec--stages--config--workload_template--backend_file_path"></a>
### Nested Schema for `spec.stages.config.workload_template.backend_file_path`

Optional:

- `name` (String) relative path of a artifact


<a id="nestedblock--spec--stages--config--workload_template--backend_vars"></a>
### Nested Schema for `spec.stages.config.workload_template.backend_vars`

Optional:

- `key` (String) variable key
- `type` (String) variable type
- `value` (String) variable value


<a id="nestedblock--spec--stages--config--workload_template--env_vars"></a>
### Nested Schema for `spec.stages.config.workload_template.env_vars`

Optional:

- `key` (String) variable key
- `type` (String) variable type
- `value` (String) variable value


<a id="nestedblock--spec--stages--config--workload_template--input_vars"></a>
### Nested Schema for `spec.stages.config.workload_template.input_vars`

Optional:

- `key` (String) variable key
- `type` (String) variable type
- `value` (String) variable value


<a id="nestedblock--spec--stages--config--workload_template--targets"></a>
### Nested Schema for `spec.stages.config.workload_template.targets`

Optional:

- `name` (String) name of terraform target


<a id="nestedblock--spec--stages--config--workload_template--tf_vars_file_path"></a>
### Nested Schema for `spec.stages.config.workload_template.tf_vars_file_path`

Optional:

- `name` (String) relative path of a artifact



<a id="nestedblock--spec--stages--config--agents"></a>
### Nested Schema for `spec.stages.config.workload_template`

Optional:

- `name` (String) name of the agent


<a id="nestedblock--spec--stages--config--approvers"></a>
### Nested Schema for `spec.stages.config.workload_template`

Optional:

- `sso_user` (Boolean) flag to specify if the user is a SSO User
- `user_name` (String) user name of the approver


<a id="nestedblock--spec--stages--config--destination_repo"></a>
### Nested Schema for `spec.stages.config.workload_template`

Optional:

- `path` (Block List, Max: 1) relative folder path in the git repo (see [below for nested schema](#nestedblock--spec--stages--config--workload_template--path))
- `repository` (String) name of the git repository
- `revision` (String) branch or tag in the git repository

<a id="nestedblock--spec--stages--config--workload_template--path"></a>
### Nested Schema for `spec.stages.config.workload_template.path`

Optional:

- `name` (String) relative path of a artifact



<a id="nestedblock--spec--stages--config--excluded_resources"></a>
### Nested Schema for `spec.stages.config.workload_template`

Optional:

- `name` (String) name of the system sync resource


<a id="nestedblock--spec--stages--config--included_resources"></a>
### Nested Schema for `spec.stages.config.workload_template`

Optional:

- `name` (String) name of the system sync resource


<a id="nestedblock--spec--stages--config--overrides"></a>
### Nested Schema for `spec.stages.config.workload_template`

Optional:

- `template` (Block List, Max: 1) (see [below for nested schema](#nestedblock--spec--stages--config--workload_template--template))
- `type` (String) type of override template
- `weight` (Number) weight of the override, overrides are applied low to high weight

<a id="nestedblock--spec--stages--config--workload_template--template"></a>
### Nested Schema for `spec.stages.config.workload_template.template`

Optional:

- `inline` (String) inline override template
- `paths` (Block List) paths in the repository containing the override template (see [below for nested schema](#nestedblock--spec--stages--config--workload_template--template--paths))
- `repository` (String) git repository containing the override template
- `revision` (String) branch or tag in the repository

<a id="nestedblock--spec--stages--config--workload_template--template--paths"></a>
### Nested Schema for `spec.stages.config.workload_template.template.revision`

Optional:

- `name` (String) relative path of a artifact




<a id="nestedblock--spec--stages--config--placement"></a>
### Nested Schema for `spec.stages.config.workload_template`

Optional:

- `labels` (Block List) list of labels for placement (see [below for nested schema](#nestedblock--spec--stages--config--workload_template--labels))
- `selector` (String) Kubernetes style label selector

<a id="nestedblock--spec--stages--config--workload_template--labels"></a>
### Nested Schema for `spec.stages.config.workload_template.labels`

Optional:

- `key` (String) Key of the placement label
- `value` (String) Value of the placement label



<a id="nestedblock--spec--stages--config--source_repo"></a>
### Nested Schema for `spec.stages.config.workload_template`

Optional:

- `path` (Block List, Max: 1) relative folder path in the git repo (see [below for nested schema](#nestedblock--spec--stages--config--workload_template--path))
- `repository` (String) name of the git repository
- `revision` (String) branch or tag in the git repository

<a id="nestedblock--spec--stages--config--workload_template--path"></a>
### Nested Schema for `spec.stages.config.workload_template.path`

Optional:

- `name` (String) relative path of a artifact




<a id="nestedblock--spec--stages--next"></a>
### Nested Schema for `spec.stages.next`

Optional:

- `name` (String) name of the next stage
- `weight` (Number) weight of the next stage


<a id="nestedblock--spec--stages--pre_conditions"></a>
### Nested Schema for `spec.stages.pre_conditions`

Optional:

- `config` (Block List, Max: 1) (see [below for nested schema](#nestedblock--spec--stages--pre_conditions--config))
- `type` (String) type of the stage precondiiton

<a id="nestedblock--spec--stages--pre_conditions--config"></a>
### Nested Schema for `spec.stages.pre_conditions.type`



<a id="nestedblock--spec--stages--variables"></a>
### Nested Schema for `spec.stages.variables`

Optional:

- `name` (String) name of the variable
- `type` (String) type of the variable
- `value` (String) value of the variable



<a id="nestedblock--spec--triggers"></a>
### Nested Schema for `spec.triggers`

Optional:

- `config` (Block List, Max: 1) (see [below for nested schema](#nestedblock--spec--triggers--config))
- `name` (String) name of the trigger
- `type` (String) trigger type
- `variables` (Block List) trigger scoped variables (see [below for nested schema](#nestedblock--spec--triggers--variables))

<a id="nestedblock--spec--triggers--config"></a>
### Nested Schema for `spec.triggers.config`

Optional:

- `cron_expression` (String) cron expression for trigger
- `repo` (Block List, Max: 1) (see [below for nested schema](#nestedblock--spec--triggers--config--repo))

<a id="nestedblock--spec--triggers--config--repo"></a>
### Nested Schema for `spec.triggers.config.repo`

Optional:

- `chart_name` (String) name of the chart in repo
- `chart_version` (String) version of the chart in repo
- `paths` (Block List) paths in the git repo to watch for changes (see [below for nested schema](#nestedblock--spec--triggers--config--repo--paths))
- `provider` (String) provider for the git repo
- `repository` (String) name of the helm repository
- `revision` (String) branch or tag in the git repository to watch for changes

<a id="nestedblock--spec--triggers--config--repo--paths"></a>
### Nested Schema for `spec.triggers.config.repo.paths`

Optional:

- `name` (String) relative path of a artifact




<a id="nestedblock--spec--triggers--variables"></a>
### Nested Schema for `spec.triggers.variables`

Optional:

- `name` (String) name of the variable
- `type` (String) type of the variable
- `value` (String) value of the variable



<a id="nestedblock--spec--variables"></a>
### Nested Schema for `spec.variables`

Optional:

- `name` (String) name of the variable
- `type` (String) type of the variable
- `value` (String) value of the variable



<a id="nestedblock--timeouts"></a>
### Nested Schema for `timeouts`

Optional:

- `create` (String)
- `delete` (String)
- `update` (String)


