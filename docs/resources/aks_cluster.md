---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "rafay_aks_cluster Resource - terraform-provider-rafay"
subcategory: ""
description: |-
  
---

# rafay_aks_cluster (Resource)

This example is for the AKS Cluster. 

## Example Usage

```terraform
resource "rafay_aks_cluster" "demo-terraform" {
  apiversion = "rafay.io/v1alpha1"
  kind       = "Cluster"
  metadata {
    name    = "demo-terraform"
    project = "terraform"
  }
  spec {
    type          = "aks"
    blueprint     = "default-aks"
    cloudprovider = "testuser-azure"
    cluster_config {
      apiversion = "rafay.io/v1alpha1"
      kind       = "aksClusterConfig"
      metadata {
        name = "demo-terraform"
      }
      spec {
        resource_group_name = "testuser-terraform"
        managed_cluster {
          apiversion = "2021-05-01"
          identity {
            type = "SystemAssigned"
          }
          location = "centralindia"
          properties {
            api_server_access_profile {
              enable_private_cluster = true
            }
            dns_prefix         = "testuser-test-dns"
            kubernetes_version = "1.21.9"
            network_profile {
              network_plugin = "kubenet"
            }
          }
          type = "Microsoft.ContainerService/managedClusters"
        }
        node_pools {
          apiversion = "2021-05-01"
          name       = "primary"
          location = "centralindia"
          properties {
            count                = 2
            enable_auto_scaling  = true
            max_count            = 2
            max_pods             = 40
            min_count            = 1
            mode                 = "System"
            orchestrator_version = "1.21.9"
            os_type              = "Linux"
            type                 = "VirtualMachineScaleSets"
            vm_size = "Standard_DS2_v2"
          }
          type = "Microsoft.ContainerService/managedClusters/agentPools"
        }
      }
    }
  }
}
```

<!-- schema generated by tfplugindocs -->
## Argument Reference 

### Required

- `apiVersion` - (String) The Rafay API version used for the cluster. The supported value is `rafay.io/v1alpha1`. 
- `kind` - (String) The type of resource. The supported value is `Cluster`. 
- `metadata` - (Block List, Max: 1) Contains data that helps uniquely identify the resource. (See [below for nested schema](#nestedblock--metadata))
- `spec` - (Block List, Max: 1) Defines the characteristics for the resource. This is the desired state for the resource. (See [below for nested schema](#nestedblock--spec))

### Optional

- `timeouts` - (Block) Sets the duration of time the create, delete, and update functions are allowed to run. If the function takes longer than this, it is assumed the function has failed. The default is 10 minutes. (See [below for nested schema](#nestedblock--timeouts))

<a id="nestedblock--metadata"></a>
### Nested Schema for `metadata`

***Required***

- `name` - (String) The name of the AKS Cluster. This must be unique in your organization. 
- `project` - (String) The name of the Rafay project the cluster will be created in.

***Optional***

- `labels` - (Map of String) The labels for the cluster. 

<a id="nestedblock--spec"></a>
### Nested Schema for `spec`

***Required***

- `cloudprovider` - (String) The name of the cloud credentials used to create and manage the cluster.
- `cluster_config` - (Block List, Min: 1) The AKS specific cluster configuration. (See [below for nested schema](#nestedblock--spec--cluster_config))
- `type` - (String) The AKS Cluster type. The supported value is `aks`. 

***Optional***

- `blueprint` - (String) The blueprint used with the cluster. The default is `default-aks`.
- `blueprintversion` - (String) The blueprint version used with the cluster. The default is the latest version. 

<a id="nestedblock--spec--cluster_config"></a>
### Nested Schema for `spec.cluster_config`

***Required***

- `apiversion` - (String) The Rafay API version used for the cluster. The supported value is `rafay.io/v1alpha1`.
- `metadata` - (Block List, Min: 1) AKS specific cluster configuration metadata. (See [below for nested schema](#nestedblock--spec--cluster_config--metadata))
- `spec` - (Block List, Min: 1) AKS specific cluster configuration spec. (See [below for nested schema](#nestedblock--spec--cluster_config--spec))
- `kind` - (String) The AKS cluster configuration. The supported value is `aksClusterConfig`. 

<a id="nestedblock--spec--cluster_config--metadata"></a>
### Nested Schema for `spec.cluster_config.metadata`

***Required***

- `name` - (String) The name of the AKS cluster. 


<a id="nestedblock--spec--cluster_config--spec"></a>
### Nested Schema for `spec.cluster_config.spec`

***Required***

- `managed_cluster` - (Block List) The AKS managed cluster. (See [below for nested schema](#nestedblock--spec--cluster_config--spec--managed_cluster))
- `node_pools` - (Block List, Min: 1) The AKS node pool. (See [below for nested schema](#nestedblock--spec--cluster_config--spec--node_pools))
- `resource_group_name` - (String) The AKS resource group for the cluster. 


<a id="nestedblock--spec--cluster_config--spec--managed_cluster"></a>
### Nested Schema for `spec.cluster_config.spec.managed_cluster`

***Required***

- `apiversion` - (String) The Azure resource managed cluster API version. The supported value is `2021-05-01`. 
- `location` - (String) The AKS cluster location.
- `properties` - (Block List, Min: 1) The properties of the managed cluster. (See [below for nested schema](#nestedblock--spec--cluster_config--spec--managed_cluster--properties))
- `type` - (String) The supported value is `Microsoft.ContainerService/managedClusters`.

***Optional***

- `additional_metadata` - (Block List) Additional metadata associated with the managed cluster. (See [below for nested schema](#nestedblock--spec--cluster_config--spec--managed_cluster--additional_metadata))
- `identity` - (Block List) Identity for the managed cluster. (See [below for nested schema](#nestedblock--spec--cluster_config--spec--managed_cluster--identity))
- `sku` - (Block List) The SKU of a Managed Cluster. (See [below for nested schema](#nestedblock--spec--cluster_config--spec--managed_cluster--sku))
- `tags` - (Map of String) Resource tags.


<a id="nestedblock--spec--cluster_config--spec--managed_cluster--properties"></a>
### Nested Schema for `spec.cluster_config.spec.managed_cluster.properties`

***Required***

- `kubernetes_version` - (String) Kubernetes version

***Optional***

- `api_server_access_profile` - (Block List) The AKS managed cluster API server access profile. (See [below for nested schema](#nestedblock--spec--cluster_config--spec--managed_cluster--properties--api_server_access_profile))
- `disk_encryption_set_id` - (String) The ID of the Disk Encryption Set which should be used for the Nodes and Volumes. This is of the form: `/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.Compute/diskEncryptionSets/{encryptionSetName}`
- `dns_prefix` - (String) DNS prefix specified when creating the managed cluster. 
This cannot be updated once the Managed Cluster has been created.
- `identity_profile` - (Map of String) Identities associated with the cluster.
- `network_profile` - (Block List) Profile of the network configuration. (See [below for nested schema](#nestedblock--spec--cluster_config--spec--managed_cluster--properties--network_profile))
- `node_resource_group` - (String) The name of the resource group containing agent pool nodes.
- `service_principal_profile` - (Block List) Information about a service principal identity for the cluster to use for manipulating Azure APIs. (See [below for nested schema](#nestedblock--spec--cluster_config--spec--managed_cluster--properties--service_principal_profile))


<a id="nestedblock--spec--cluster_config--spec--managed_cluster--properties--api_server_access_profile"></a>
### Nested Schema for `spec.cluster_config.spec.managed_cluster.properties.api_server_access_profile`

***Optional***

- `authorized_ip_ranges` - (List of String) The AKS managed cluster properties server access profile server access profile. 
- `enable_private_cluster` - (Boolean) Enable an AKS private cluster.
- `private_dns_zone` - (String) The AKS managed cluster properties private DNS zone. **Note**: The value needs to be set to `null` or empty when the `enable_private_cluster` is set to `false`. 


<a id="nestedblock--spec--cluster_config--spec--managed_cluster--properties--network_profile"></a>
### Nested Schema for `spec.cluster_config.spec.managed_cluster.properties.network_profile`

***Optional***

- `dns_service_ip` - (String) An IP address assigned to the Kubernetes DNS service.
- `docker_bridge_cidr` - (String) A CIDR notation IP range assigned to the Docker bridge network.
- `load_balancer_sku` - (String) Supported values are: `standard` and `basic`.
- `network_mode` - (String) This cannot be specified if `networkPlugin` is anything other than `azure`. The supported values are `transparent` and `bridge`. 
- `network_plugin` - (String) The network plugin used for building the Kubernetes network. Supported values are: `azure` and `kubenet`.
- `network_policy` - (String) The network policy used for building the Kubernetes network. Supported values are: `calico` and `azure`.
- `pod_cidr` - (String) A CIDR notation IP range from which to assign pod IPs when kubenet is used.
- `service_cidr` - (String) A CIDR notation IP range from which to assign service cluster IPs.


<a id="nestedblock--spec--cluster_config--spec--managed_cluster--properties--service_principal_profile"></a>
### Nested Schema for `spec.cluster_config.spec.managed_cluster.properties.service_principal_profile`

***Required***

- `client_id` - (String) The ID for the service principal. If specified, must be set to `[parameters('servicePrincipalClientId')]`. This would be set to the cloud credential's client ID during cluster deployment.
- `secret` - (String) The secret password associated with the service principal in plain text.


<a id="nestedblock--spec--cluster_config--spec--managed_cluster--additional_metadata"></a>
### Nested Schema for `spec.cluster_config.spec.managed_cluster.additional_metadata`

***Optional***

- `acr_profile` - (Block List) The profile for the Azure Container Registry configuration. (See [below for nested schema](#nestedblock--spec--cluster_config--spec--managed_cluster--additional_metadata--acr_profile))


<a id="nestedblock--spec--cluster_config--spec--managed_cluster--additional_metadata--acr_profile"></a>
### Nested Schema for `spec.cluster_config.spec.managed_cluster.additional_metadata.acr_profile`

***Required***

- `acr_name` - (String) The name of the Azure Container Registry resource.
- `resource_group_name` - (String) If not specified, defaults to the resource group of the managed cluster. 


<a id="nestedblock--spec--cluster_config--spec--managed_cluster--identity"></a>
### Nested Schema for `spec.cluster_config.spec.managed_cluster.identity`

***Required***

- `type` - (String) The identity type for the AKS cluster. For more information see [Use managed identities in AKS](https://docs.microsoft.com/en-us/azure/aks/use-managed-identity). Supported values are: `SystemAssigned`, `UserAssigned`, and `None`.


<a id="nestedblock--spec--cluster_config--spec--managed_cluster--sku"></a>
### Nested Schema for `spec.cluster_config.spec.managed_cluster.sku`

***Required***

- `name` - (String) The name of a managed cluster SKU. The supported value is `Basic`.
- `tier` - (String) Supported values are: `Paid` and `Free`.


<a id="nestedblock--spec--cluster_config--spec--node_pools"></a>
### Nested Schema for `spec.cluster_config.spec.node_pools`

***Required***

- `apiversion` - (String) The AKS node pool API version. The supported value is `2021-05-01`.
- `location` - (String) The AKS node pool location. 
- `name` - (String) The AKS node pool name. 
- `properties` - (Block List, Min: 1) The AKS managed cluster properties. (See [below for nested schema](#nestedblock--spec--cluster_config--spec--node_pools--properties))
- `type` - (String) The AKS node pool type. The supported value is `Microsoft.ContainerService/managedClusters/agentPools`. 

<a id="nestedblock--spec--cluster_config--spec--node_pools--properties"></a>
### Nested Schema for `spec.cluster_config.spec.node_pools.properties`

***Optional***

- `availability_zones` - (List of String) The list of availability zones to use for nodes. This can only be specified if the `AgentPoolType` property is `VirtualMachineScaleSets`.
- `count` - (Number) The number of agents (VMs) to host docker containers. Allowed values must be in the range of `0` to `1000` (inclusive) for user pools and in the range of `1` to `1000` (inclusive) for system pools. The default value is `1`.
- `enable_auto_scaling` - (Boolean) Enables the auto-scaler. 
- `max_count` - (Number) The maximum number of nodes for auto-scaling.
- `max_pods` - (Number) The maximum number of pods that can run on a node.
- `min_count` - (Number) The minimum number of nodes for auto-scaling
- `mode` - (String) The mode for a node pool which defines a node pool's primary function. If set as `System`, AKS prefers system pods scheduling to node pools with mode `System`. Supported values are: `System` and `User`.
- `node_labels` - (Map of String) Node labels. 
- `node_taints` - (List of String) The taints added to new nodes during node pool create and scale. For example, key=value:NoSchedule.
- `orchestrator_version` - (String) The AKS node pool Kubernetes version. 
- `os_disk_size_gb` - (Number) OS Disk Size in GB to be used to specify the disk size for every machine in the master/agent pool.
- `os_disk_type` - (String) Supported values are: `Managed` and `Ephemeral`.
- `os_type` - (String) Supported values are: `Linux` and `Windows`.
- `pod_subnet_id` - (String) If omitted, pod IPs are statically assigned on the node subnet (See vnet_subnet_id for more details). This is of the form: `/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.Network/virtualNetworks/{virtualNetworkName}/subnets/{subnetName}`.
- `scale_set_eviction_policy` - (String) This cannot be specified unless the `scaleSetPriority` is `Spot`. If not specified, the default is `Delete`. Supported values are: `Delete` and `Deallocate`.
- `scale_set_priority` - (String) The virtual machine scale set priority. If not specified, the default is `Regular`. Supported values are: `Spot` and `Regular`. 
- `spot_max_price` - (Number) Supported values are: any decimal value greater than zero or -1 (which indicates the willingness to pay any on-demand price). For more details on spot pricing, see [Azure Spot Virtual Machines](https://azure.microsoft.com/en-us/services/virtual-machines/spot/).
- `type` - (String) Supported values are `VirtualMachineScaleSets` and `AvailabilitySet`.
- `upgrade_settings` - (Block List) Settings for upgrading an agentpool. (See [below for nested schema](#nestedblock--spec--cluster_config--spec--node_pools--properties--upgrade_settings))
- `vm_size` - (String) The AKS node pool VM size.
- `vnet_subnet_id` - (String) If this is not specified, a VNET and subnet will be generated and used. If no `podSubnetID` is specified, this applies to nodes and pods, otherwise it applies to just nodes.

<a id="nestedblock--spec--cluster_config--spec--node_pools--properties--upgrade_settings"></a>
### Nested Schema for `spec.cluster_config.spec.node_pools.properties.upgrade_settings`

***Optional***

- `max_surge` - (String) This can either be set to an integer (e.g. 5) or a percentage (e.g. 50%). See [Customize node surge upgrade](https://docs.microsoft.com/en-us/azure/aks/upgrade-cluster#customize-node-surge-upgrade) for more details. 


<a id="nestedblock--timeouts"></a>
### Nested Schema for `timeouts`

***Optional***
- `create` - (String) Sets the timeout duration for creating a resource. The default timeout is 10 minutes. 
- `delete` - (String) Sets the timeout duration for deleting a resource. The default timeout is 10 minutes. 
- `update` - (String) Sets the timeout duration for updating a resource. The default timeout is 10 minutes. 

## Attribute Reference

---

- `id` - (String) The ID of the resource, generated by the system after you create the resource. 
